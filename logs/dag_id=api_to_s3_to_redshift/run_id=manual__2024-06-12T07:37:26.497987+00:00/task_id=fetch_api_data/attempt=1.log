[2024-06-12T07:37:32.118+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: api_to_s3_to_redshift.fetch_api_data manual__2024-06-12T07:37:26.497987+00:00 [queued]>
[2024-06-12T07:37:32.164+0000] {taskinstance.py:1083} INFO - Dependencies all met for <TaskInstance: api_to_s3_to_redshift.fetch_api_data manual__2024-06-12T07:37:26.497987+00:00 [queued]>
[2024-06-12T07:37:32.165+0000] {taskinstance.py:1279} INFO - 
--------------------------------------------------------------------------------
[2024-06-12T07:37:32.165+0000] {taskinstance.py:1280} INFO - Starting attempt 1 of 2
[2024-06-12T07:37:32.165+0000] {taskinstance.py:1281} INFO - 
--------------------------------------------------------------------------------
[2024-06-12T07:37:32.240+0000] {taskinstance.py:1300} INFO - Executing <Task(PythonOperator): fetch_api_data> on 2024-06-12 07:37:26.497987+00:00
[2024-06-12T07:37:32.265+0000] {standard_task_runner.py:55} INFO - Started process 7425 to run task
[2024-06-12T07:37:32.279+0000] {standard_task_runner.py:82} INFO - Running: ['***', 'tasks', 'run', 'api_to_s3_to_redshift', 'fetch_api_data', 'manual__2024-06-12T07:37:26.497987+00:00', '--job-id', '20', '--raw', '--subdir', 'DAGS_FOLDER/test_redshift_real.py', '--cfg-path', '/tmp/tmph9mhwhb8']
[2024-06-12T07:37:32.284+0000] {standard_task_runner.py:83} INFO - Job 20: Subtask fetch_api_data
[2024-06-12T07:37:32.594+0000] {task_command.py:388} INFO - Running <TaskInstance: api_to_s3_to_redshift.fetch_api_data manual__2024-06-12T07:37:26.497987+00:00 [running]> on host be394f3a6896
[2024-06-12T07:37:32.913+0000] {taskinstance.py:1509} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=api_to_s3_to_redshift
AIRFLOW_CTX_TASK_ID=fetch_api_data
AIRFLOW_CTX_EXECUTION_DATE=2024-06-12T07:37:26.497987+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=manual__2024-06-12T07:37:26.497987+00:00
[2024-06-12T07:37:34.823+0000] {taskinstance.py:1768} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 509, in _to_datetime_with_format
    values, tz = conversion.datetime_to_datetime64(arg)
  File "pandas/_libs/tslibs/conversion.pyx", line 359, in pandas._libs.tslibs.conversion.datetime_to_datetime64
TypeError: Unrecognized value type: <class 'str'>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 175, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 192, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/test_redshift_real.py", line 65, in fetch_api_data
    df['date'] = pd.to_datetime(df['date'], format='%Y%m%d%H')
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 887, in to_datetime
    values = convert_listlike(arg._values, format)
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 394, in _convert_listlike_datetimes
    arg, orig_arg, name, tz, format, exact, errors, infer_datetime_format
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 513, in _to_datetime_with_format
    raise err
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 501, in _to_datetime_with_format
    arg, name, tz, fmt, exact, errors, infer_datetime_format
  File "/home/airflow/.local/lib/python3.7/site-packages/pandas/core/tools/datetimes.py", line 436, in _array_strptime_with_fallback
    result, timezones = array_strptime(arg, fmt, exact=exact, errors=errors)
  File "pandas/_libs/tslibs/strptime.pyx", line 156, in pandas._libs.tslibs.strptime.array_strptime
ValueError: unconverted data remains: 00
[2024-06-12T07:37:34.850+0000] {taskinstance.py:1323} INFO - Marking task as UP_FOR_RETRY. dag_id=api_to_s3_to_redshift, task_id=fetch_api_data, execution_date=20240612T073726, start_date=20240612T073732, end_date=20240612T073734
[2024-06-12T07:37:34.895+0000] {standard_task_runner.py:105} ERROR - Failed to execute job 20 for task fetch_api_data (unconverted data remains: 00; 7425)
[2024-06-12T07:37:34.928+0000] {local_task_job.py:208} INFO - Task exited with return code 1
[2024-06-12T07:37:35.018+0000] {taskinstance.py:2578} INFO - 0 downstream tasks scheduled from follow-on schedule check
